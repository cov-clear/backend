{
  "$schema": "http://json-schema.org/draft-04/schema#",
  "$id": "https://cov-clear.com/certificate.schema.json",
  "title": "Passport Document",
  "description": "A cryptographically signed document containing details of an individual (the holder)'s medical test results.",
  "type": "object",
  "properties": {
    "ct": {
      "title": "Certificate Section",
      "description": "Section containing all of the data relating to the medical test, the holder, and the authority that issued the certificate.",
      "type": "object",
      "properties": {
        "v": {
          "title": "Version",
          "description": "Version of the cov-clear certificate schema to which this certificate conforms.",
          "type": "string"
        },
        "t": {
          "title": "Test",
          "description": "Section containing medical information about the test performed and its result.",
          "type": "object",
          "properties": {
            "ts": {
              "title": "Timestamp",
              "description": "Timestamp for when the test was taken.",
              "$comment": "This should be in unix timestamp format (seconds since epoch)",
              "type": "number"
            },
            "mod": {
              "title": "Test model",
              "description": "An identifier for a known model of medical test",
              "$comment": "Whilst including a url here could be useful, a more compact value might be preferable.",
              "type": "string",
              "examples": [
	        "Biopanda Reagents RAPG-COV-019",
	        "Randox Health COVID-19 HOME TESTING KIT"
	      ]
            },
            "sn": {
              "title": "Test Serial Number",
              "description": "Serial number of the specific test unit used.",
              "type": "string"
            },
            "res": {
              "title": "Test Results",
              "description": "Detailed results of the mdeical test.",
              "$comment": "Note that this schema only includes results for a standard lateral flow rapid diagnostic test (RDT). ",
              "type": "object",
              "properties": {
                "c": {
                  "title": "Control Reading",
                  "description": "Output of the RDT's control line.",
                  "type": "boolean"
                },
                "igg": {
                  "title": "IgG Reading",
                  "description": "Output of the RDT's IgG antibody line.",
                  "type": "boolean"
                },
                "igm": {
                  "title": "IgM Reading",
                  "description": "Output of the RDT's IgM antibody line.",
                  "type": "boolean"
                }
              },
	      "required": [ "c", "igg", "igm" ]
            }
          },
	  "required": [ "ts", "mod", "res" ]
        },
        "id": {
          "title": "Identification",
          "description": "Section identifying the identity document to which this certificate relates.",
          "$comment": "The certificate holder should present the id document in order to prove ownership of the certificate",
          "type": "object",
          "properties": {
            "loc": {
              "title": "Document Locale",
              "description": "An ISO-3166 country code representing the locale for which this identity document is valid.",
              "type": "string",
              "examples": [
	       "GB",
	       "EE",
	       "US"
	      ]
            },
            "type": {
              "title": "Document Type",
              "description": "Type of identity document.",
              "type": "string",
              "examples": [
	       "Passport",
	       "Driving License",
	       "National Identity Card"
	      ]
            },
            "id": {
              "title": "Document ID",
              "description": "Identifier for the document.",
              "type": "string"
            }
          },
	  "required": [ "loc", "type", "id" ]
        },
        "auth": {
          "title": "Authority",
          "description": "Section containing details of the testing authority that performed the test and thus issued the certificate.",
          "type": "object",
          "properties": {
            "aki": {
              "title": "Authority Key Identifier",
              "description": "ID for the public key corresponding to the private key with which this document was signed.",
              "$comment": "This identifies the performer of the test, and acts as a quick way for a verifying application to identify the public key with which the signature can be verified",
              "type": "string"
            },
            "name": {
              "title": "Name of the authority that performed the test",
              "description": "Name of the authority that performed the test.",
              "type": "string",
              "examples": [
	        "UK, South London Covid mobile testing station",
	        "EE, Saaremaa Immunity Testing Laboratory"
	      ]
            }
          },
	  "required": [ "aki" ]
        }
      },
      "required": [ "v", "t", "id", "auth" ]
    },
    "sig": {
      "title": "Signature",
      "description": "A base64 encoded X-bit signature for the ct section created using the signing authority's private key.",
      "$comment": "Whitespace should be removed from the ct section (e.g. using jq . -c) prior to generating the signature.",
      "$comment": "TODO(explain in more detail how to create certs etc).",
      "type": "string"
    }
  },
  "required": [ "ct", "sig" ]
}
