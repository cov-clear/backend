{
  "$schema": "http://json-schema.org/draft-04/schema#",
  "$id": "https://cov-clear.com/passport.schema.json",
  "title": "Passport Document",
  "description": "A cryptographically signed document containing details of an individual (the holder)'s medical test results",
  "type": "object",
  "properties": {
    "pp": {
      "title": "Passport Section",
      "description": "Section containing all of the data relating to the medical test, the test performer and it's subject",
      "type": "object",
      "properties": {
        "v": {
          "title": "Version",
          "description": "Version of the cov-clear passport schema to which this passport document conforms",
          "type": "string"
        },
        "t": {
          "title": "Test",
          "description": "Section containing medical information about the test performed and its result.",
          "type": "object",
          "properties": {
            "ts": {
              "title": "Timestamp",
              "description": "Timestamp for when the test was taken.",
              "$comment": "This should be in unix timestamp format (seconds since epoch)",
              "type": "number"
            },
            "mod": {
              "title": "Test model",
              "description": "A hyperlink to a known test model, ideally on the website of the manufacturer",
              "type": "string"
            },
            "sn": {
              "title": "Test Serial Number",
              "description": "Serial number of the specific test unit used",
              "type": "string"
            },
            "res": {
              "title": "Test Results",
              "description": "Detailed results of the test",
              "$comment": "Note that this schema only includes results for a standard lateral flow rapid diagnostic test (RDT). ",
              "type": "object",
              "properties": {
                "c": {
                  "title": "Control Reading",
                  "description": "Output of the RDT's control line",
                  "type": "boolean"
                },
                "igg": {
                  "title": "IgG Reading",
                  "description": "Output of the RDT's IgG antibody line",
                  "type": "boolean"
                },
                "igm": {
                  "title": "IgM Reading",
                  "description": "Output of the RDT's IgM antibody line",
                  "type": "boolean"
                }
              },
	      "required": [ "c", "igg", "igm" ]
            }
          },
	  "required": [ "ts", "mod", "res" ]
        },
        "id": {
          "title": "Identification",
          "description": "Section identifying the identity document to which this passport relates.",
          "$comment": "The passport holder should present the id document in order to prove ownership of the passport",
          "type": "object",
          "properties": {
            "loc": {
              "title": "Document Locale",
              "description": "Locale for which this identity document is valid.",
              "type": "string"
            },
            "type": {
              "title": "Document Type",
              "description": "Type of identity document",
              "type": "string"
            },
            "id": {
              "title": "Document ID",
              "description": "Identifier for the document.",
              "type": "string"
            }
          },
	  "required": [ "loc", "type", "id" ]
        },
        "auth": {
          "title": "Authority",
          "description": "",
          "type": "object",
          "properties": {
            "aki": {
              "title": "Authority Key Identifier",
              "description": "ID for the public key corresponding to the private key with which this document was signed",
              "$comment": "This identifies the performer of the test, and acts as a quick way for a verifying apoplication to identify the public key with which the signature can be verified",
              "type": "string"
            },
            "name": {
              "title": "Name of the authority that performed the test",
              "description": "Name of the authority that performed the test",
              "type": "string"
            }
          },
	  "required": [ "aki" ]
        }
      },
      "required": [ "v", "r", "id", "auth" ]
    },
    "sig": {
      "title": "Signature",
      "description": "A base64 encoded X-bit signature for the pp section created using the signing authority's private key.",
      "$comment": "Whitespace should be removed from the pp section (e.g. using jq . -c) prior to generating the signature.",
      "type": "string"
    }
  },
  "required": [ "pp", "sig" ]
}
